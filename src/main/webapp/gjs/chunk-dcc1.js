(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-dcc1"],{"0GBT":function(t,e,a){},"DF/b":function(t,e,a){"use strict";a.r(e);var r=a("VcQl"),i=a.n(r);for(var n in r)"default"!==n&&function(t){a.d(e,t,function(){return r[t]})}(n);e.default=i.a},JEsQ:function(t,e,a){"use strict";a.r(e);var r=a("ejLg"),i=a("DF/b");for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);a("mypK");var s=a("KHd+"),o=Object(s.a)(i.default,r.a,r.b,!1,null,null,null);o.options.__file="index.vue",e.default=o.exports},VcQl:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=l(a("EJiy")),i=l(a("P2sY")),n=l(a("gDS+")),s=a("tQZy"),o=a("fnnb"),c=l(a("nw5j")),u=a("Yfch");function l(t){return t&&t.__esModule?t:{default:t}}e.default={components:{VueCropper:o.VueCropper,areaPicker:c.default},data:function(){return{status:1,isHongKong:!1,areaShow:!1,cropperVisible:!1,cropConfig:{img:"",size:1,outputType:"jpeg",canScale:!0,autoCrop:!0,autoCropWidth:200,autoCropHeight:150},headPortrait:"",settingFormData:{birthday:""},rules:{nickname:[{required:!0,message:"请输入昵称",trigger:["blur","change"]}],realName:[{required:!0,message:"真实姓名不能为空",trigger:["blur","change"]}],gender:[{required:!0,message:"请选择性别",trigger:["blur"]}],birthday:[{required:!0,message:"请选择生日",trigger:["blur","change"]}],area:[{required:!0,message:"请选择省市区",trigger:["blur","change"]}],homeAddress:[{required:!0,validator:this.validateAddress,trigger:["blur","change"]}]},pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},castGender:"2"}},created:function(){var t=this;(0,s.getUserDetail)().then(function(e){var a=e.result;t.headPortrait=a.headPortrait||"/static/images/home/t.png",t.settingFormData=JSON.parse((0,n.default)(a)),a.province&&a.city&&a.district&&(t.settingFormData.area=a.province+"-"+a.city+"-"+a.district),"0"===a.gender?t.settingFormData.gender="男":"1"===a.gender?t.settingFormData.gender="女":t.settingFormData.gender="",t.castGender=a.gender}).catch(function(e){t.headPortrait="/static/images/home/t.png",t.$message({message:e,type:"error",duration:1e3})})},methods:{modify:function(){this.status=2,console.log(this.settingFormData.birthday)},getBirth:function(t){this.settingFormData.birthday=(0,u.formatTime)(this.settingFormData.birthday)},validateAddress:function(t,e,a){e?!e.match(/[\u4e00-\u9fa5]/g)||e.match(/[\u4e00-\u9fa5]/g).length<4?a(new Error("详细地址不能少于四个汉字")):a():a(new Error("请填写详细地址"))},getGender:function(){"男"===this.settingFormData.gender?this.castGender="0":"女"===this.settingFormData.gender?this.castGender="1":this.castGender="2"},openArea:function(){this.areaShow=!0},getAreaData:function(t){this.settingFormData=(0,i.default)({},this.settingFormData,t),this.$set(this.settingFormData,"area",t.province+"-"+t.city+"-"+t.district)},submitForm:function(){var t=this;this.$refs.settingFormData.validate(function(e){e&&(console.log(e),(0,s.updateUserSetting)({birthday:t.settingFormData.birthday,realName:t.settingFormData.realName,districtId:Number(t.settingFormData.districtId),gender:t.castGender,province:t.settingFormData.province,city:t.settingFormData.city,district:t.settingFormData.district,nickname:t.settingFormData.nickname,cityId:Number(t.settingFormData.cityId),provinceId:Number(t.settingFormData.provinceId),homeAddress:t.settingFormData.homeAddress}).then(function(e){t.$message({message:"设置成功",type:"success"}),t.status=1}))})},cancel:function(){this.$refs.files.value="",this.cropperVisible=!1},finish:function(t){var e=this;this.$refs.cropper.getCropData(function(t){e.cropperVisible=!1,e._updatePortrait(t)})},uploadImg:function(t,e){var a=this;this.cropConfig.img="";var i=t.target.files[0];if(!/\.(gif|jpg|jpeg|png|bmp|GIF|JPG|PNG)$/.test(t.target.value))return this.$message({message:"图片类型必须是.gif,jpeg,jpg,png,bmp中的一种",type:"error",duration:1e3}),!1;var n=new FileReader;n.onload=function(t){var e=void 0;e=t.target.result,e="object"===(0,r.default)(t.target.result)?window.URL.createObjectURL(new Blob([t.target.result])):t.target.result,a.cropConfig.img=e},n.readAsDataURL(i),this.cropperVisible=!0},_updatePortrait:function(t){var e=this;(0,s.updatePortrait)({strbase64date:t||""}).then(function(a){e.$message({message:"设置成功",type:"success"}),e.headPortrait=t||""}).catch(function(t){e.$message({message:t,type:"error"})})}}}},Yfch:function(t,e,a){"use strict";function r(t){return(t=t.toString())[1]?t:"0"+t}function i(t){var e=t.getFullYear(),a=t.getMonth()+1,i=t.getDate(),n=t.getHours(),s=t.getMinutes(),o=t.getSeconds();return[e,a,i].map(r).join("-")+" "+[n,s,o].map(r).join(":")}Object.defineProperty(e,"__esModule",{value:!0}),e.isvalidUsername=function(t){return["admin","editor"].indexOf(t.trim())>=0},e.validateURL=function(t){return/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(t)},e.validateLowerCase=function(t){return/^[a-z]+$/.test(t)},e.validateUpperCase=function(t){return/^[A-Z]+$/.test(t)},e.validatAlphabets=function(t){return/^[A-Za-z]+$/.test(t)},e.formatNumber=r,e.formatTime=i,e.diffMonthAgo=function(){var t=new Date((new Date).getTime());return{startTime:i(new Date((new Date).getTime()-2592e6)),endTime:i(t)}},e.validateMobile=function(t,e,a){e?e.indexOf(" ")>=0?a(new Error("手机号不能含有空格")):/^1\d{10}$/.test(e)||/^[0,4]\d{2,3}-?\d{7,8}$/.test(e)?a():a(new Error("手机号格式不正确")):a(new Error("手机号不能为空"))},e.validateAddress=function(t,e,a){e?!e.match(/[\u4e00-\u9fa5]/g)||e.match(/[\u4e00-\u9fa5]/g).length<4?a(new Error("详细地址不能少于四个汉字")):a():a(new Error("请填写详细地址"))},e.validateArea=function(t,e,a){console.log(e),e?a():a(new Error("请选择省市区"))},e.validateAddressType=function(t,e,a){e?a():a(new Error("请填写地址类型"))}},ejLg:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"personal-setting-wrapper"},[a("div",{staticClass:"header"},[t._v("个人资料设置")]),t._v(" "),a("div",{staticClass:"s-box"},[1===t.status?a("div",{staticClass:"aside"},[a("span",{staticClass:"head-pic"},[a("img",{attrs:{src:t.headPortrait}})])]):a("div",{staticClass:"aside"},[a("span",{staticClass:"head-pic"},[a("img",{attrs:{src:t.headPortrait}}),a("input",{ref:"files",attrs:{type:"file"},on:{change:function(e){t.uploadImg(e,1)}}}),a("i",[t._v("上传头像")])])]),t._v(" "),1===t.status?a("div",{staticClass:"amain"},[a("p",[a("span",[t._v("昵称:")]),t._v(t._s(t.settingFormData.nickname||"无"))]),t._v(" "),a("p",[a("span",[t._v("真实姓名:")]),t._v(t._s(t.settingFormData.realName||"无"))]),t._v(" "),0==t.castGender?a("p",[a("span",[t._v("性别:")]),t._v("男")]):t._e(),t._v(" "),1==t.castGender?a("p",[a("span",[t._v("性别:")]),t._v("女")]):t._e(),t._v(" "),2==t.castGender?a("p",[a("span",[t._v("性别:")]),t._v("无")]):t._e(),t._v(" "),a("p",[a("span",[t._v("生日:")]),t._v(t._s(t.settingFormData.birthday&&t.settingFormData.birthday.split(" ")[0]||"无"))]),t._v(" "),a("p",[a("span",[t._v("省市区:")]),t._v(t._s(t.settingFormData.area||"无"))]),t._v(" "),a("p",[a("span",[t._v("详细地址:")]),t._v(t._s(t.settingFormData.homeAddress||"无"))]),t._v(" "),a("el-button",{staticClass:"modify",attrs:{type:"primary"},on:{click:t.modify}},[t._v("修改")])],1):t._e(),t._v(" "),2===t.status?a("div",{staticClass:"amain"},[a("el-form",{ref:"settingFormData",attrs:{model:t.settingFormData,rules:t.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"请填写昵称",maxlength:"16"},model:{value:t.settingFormData.nickname,callback:function(e){t.$set(t.settingFormData,"nickname",e)},expression:"settingFormData.nickname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"真实姓名",prop:"realName"}},[a("el-input",{attrs:{placeholder:"与身份证保持一致",maxlength:"16"},model:{value:t.settingFormData.realName,callback:function(e){t.$set(t.settingFormData,"realName",e)},expression:"settingFormData.realName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"gender"}},[a("el-radio-group",{on:{change:t.getGender},model:{value:t.settingFormData.gender,callback:function(e){t.$set(t.settingFormData,"gender",e)},expression:"settingFormData.gender"}},[a("el-radio",{attrs:{label:"男"}}),t._v(" "),a("el-radio",{attrs:{label:"女"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"生日",prop:"birthday"}},[a("el-date-picker",{staticClass:"birth",attrs:{"picker-options":t.pickerOptions,editable:!1,clearable:!1,type:"date",placeholder:"年-月-日"},on:{change:function(e){t.getBirth(t.settingFormData.birthday)}},model:{value:t.settingFormData.birthday,callback:function(e){t.$set(t.settingFormData,"birthday",e)},expression:"settingFormData.birthday"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"省市区",prop:"area"}},[a("el-input",{attrs:{readonly:"",placeholder:"请选择省市区"},on:{focus:t.openArea},model:{value:t.settingFormData.area,callback:function(e){t.$set(t.settingFormData,"area",e)},expression:"settingFormData.area"}}),t._v(" "),a("area-picker",{attrs:{"area-show":t.areaShow,"is-hong-kong":t.isHongKong},on:{"update:areaShow":function(e){t.areaShow=e},callbackAreaData:t.getAreaData}})],1),t._v(" "),a("el-form-item",{attrs:{label:"详细地址",prop:"homeAddress"}},[a("el-input",{attrs:{placeholder:"请填写详细地址",maxlength:"64"},model:{value:t.settingFormData.homeAddress,callback:function(e){t.$set(t.settingFormData,"homeAddress",e)},expression:"settingFormData.homeAddress"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("settingFormData")}}},[t._v("提交")])],1)],1)],1):t._e()]),t._v(" "),a("el-dialog",{staticClass:"cropper-wrapper",attrs:{visible:t.cropperVisible,width:"50%"},on:{"update:visible":function(e){t.cropperVisible=e},close:t.cancel}},[a("vueCropper",{ref:"cropper",attrs:{img:t.cropConfig.img,"output-size":t.cropConfig.size,"output-type":t.cropConfig.outputType,"auto-crop":t.cropConfig.autoCrop,"auto-crop-width":t.cropConfig.autoCropWidth,"auto-crop-height":t.cropConfig.autoCropHeight}}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.finish}},[t._v("确 定")])],1)],1)],1)},i=[];a.d(e,"a",function(){return r}),a.d(e,"b",function(){return i})},mypK:function(t,e,a){"use strict";var r=a("0GBT");a.n(r).a},tQZy:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.updatePortrait=function(t){return(0,r.default)({url:"/User_UpdateHeadPortrait",method:"POST",data:t})},e.updateUserSetting=function(t){return(0,r.default)({url:"/User_Update",method:"POST",data:t})},e.getUserDetail=function(t){return(0,r.default)({url:"/User_GetDetail",method:"POST",data:t})};var r=function(t){return t&&t.__esModule?t:{default:t}}(a("t3Un"))}}]);